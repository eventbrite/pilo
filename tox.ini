[tox]
envlist =
    py27-django18
    py35-django18
    # py27-flake8

[testenv]
deps =
    # Django versions
    django18: django==1.8.19

extras = testing
install_command = python -m pip install {opts} {packages}
allowlist_externals = mkdir
use_develop = true

passenv =
    DJANGO_SETTINGS_MODULE

commands =
    mkdir -p /tmp/test-results/{envname}
    pytest --junit-prefix={envname} --junitxml=/tmp/test-results/{envname}/pytests.xml {posargs}
    coverage xml -o /tmp/coverage.xml

[testenv:py27-flake8]
skip_install = true
deps = flake8
commands = flake8 \
    --tee \
    --output-file=/tmp/test-artifacts/flake8-report-{envname}.txt \
    --format="{envname}: %(path)s:%(row)d:%(col)d: %(code)s %(text)s"